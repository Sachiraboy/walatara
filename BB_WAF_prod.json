{"dashboard":{"data":{"charts":[{"chart_title":"BB_WAF_PRO_table","chart_type":"table","col_end":115,"col_start":2,"row_end":79,"row_start":48,"templateID":0,"type":"custom"},{"chart_title":"BB_AWS WAF PRO - Blocks by Country","chart_type":"donut","col_end":33,"col_start":2,"row_end":32,"row_start":2,"templateID":1,"type":"custom"},{"chart_title":"AWS WAF - Blocks by Rule ID - Pie CHart","chart_type":"donut","col_end":72,"col_start":35,"row_end":32,"row_start":2,"templateID":2,"type":"custom"},{"chart_title":"AWS WAF - HTTP Request Methods - Bar Chart","chart_type":"bar","col_end":114,"col_start":72,"row_end":32,"row_start":2,"templateID":3,"type":"custom"},{"chart_title":"AWS WAF - Block Activity - Area Chart","chart_type":"line","col_end":115,"col_start":2,"row_end":46,"row_start":34,"templateID":4,"type":"custom"},{"chart_title":"URI Piechart for Non-Prod","chart_type":"donut","col_end":80,"col_start":4,"row_end":121,"row_start":80,"templateID":5,"type":"custom"}],"cust_id":"47337828","custom":false,"description":null,"height":3000,"id":"lGZsMg1aOqwwLaP1XAHUjbPdG","new":false,"padding":0,"title":"BB_WAF_prod","width":2400},"name":"BB_WAF_prod","object_type":"dashboard","template":""},"charts":[{"name":"BB_WAF_PRO_table","object_type":"chart","data":{"aggs":[],"chart_type":"table","config":{"cols":[{"id":"timestamp","name":"Time"},{"id":"aws_cloudwatch.message_obj.actio","name":"Action"},{"id":"aws_cloudwatch.message_obj.httpRequest.clientIp","name":"Source IP"},{"id":"srcip_geo.countryName","name":"Source Country Name"},{"id":"srcip_geo.countryCode","name":"Source Country Code"},{"id":"srcip_geo.city","name":"Source City"},{"id":"aws_cloudwatch.message_obj.httpRequest.headers","name":"message_obj_http_Request_headers"},{"id":"aws_cloudwatch.message_obj.ruleGroupList.terminatingRule.ruleId","name":"Rule_ID"},{"id":"aws_cloudwatch.message_obj.terminatingRuleId","name":"Custom_Rule_ID"},{"id":"aws_cloudwatch.mess","name":"HTTP Request.Method"}],"filterable":true,"index":"aella-syslog-*","query_type":{"cats":[0],"type":"custom"},"rowsPerPage":20,"sortDefault":"activityDateTime","table_type":"per_record","title":"BB_WAF_PRO_table"}},"id":0},{"name":"BB_AWS WAF PRO - Blocks by Country","object_type":"chart","data":{"aggs":[{"direction":"desc","field":"srcip_geo.countryName.keyword","info":["srcip_geo.countryName"],"metric":"doc_count","metric_field":"","name":"Column 1","size":5,"type":"bucket"}],"chart_type":"donut","config":{"filter_type":"srcip_geo.countryName.keyword","index":"aella-syslog-*","label_field":"srcip_geo.countryName","query_type":{"cats":[0],"type":"custom"},"title":"BB_AWS WAF PRO - Blocks by Country","value_field":"doc_count"}},"id":1},{"name":"AWS WAF - Blocks by Rule ID - Pie CHart","object_type":"chart","data":{"aggs":[{"direction":"desc","field":"aws_cloudwatch.message_obj.terminatingRuleId.keyword","info":["aws_cloudwatch.message_obj.terminatingRuleId"],"metric":"doc_count","metric_field":"","name":"Column 1","size":5,"type":"bucket"}],"chart_type":"donut","config":{"filter_type":"aws_cloudwatch.message_obj.terminatingRuleId.keyword","index":"aella-syslog-*","label_field":"aws_cloudwatch.message_obj.terminatingRuleId","query_type":{"cats":[0],"type":"custom"},"title":"AWS WAF - Blocks by Rule ID - Pie CHart","value_field":"doc_count"}},"id":2},{"name":"AWS WAF - HTTP Request Methods - Bar Chart","object_type":"chart","data":{"aggs":[{"direction":"desc","field":"aws_cloudwatch.message_obj.httpRequest.httpMethod.keyword","info":["aws_cloudwatch.message_obj.httpRequest.httpMethod"],"metric":"doc_count","metric_field":"","name":"Column 1","size":25,"type":"bucket"}],"chart_type":"bar","config":{"filter_type":"aws_cloudwatch.message_obj.httpRequest.httpMethod.keyword","horizontal":false,"index":"aella-syslog-*","label_field":"aws_cloudwatch.message_obj.httpRequest.httpMethod","label_x":"Request Methods","label_y":"Count","no_sort":true,"query_type":{"cats":[0],"type":"custom"},"title":"AWS WAF - HTTP Request Methods - Bar Chart","tooltip":{"aws_cloudwatch.message_obj.httpRequest.httpMethod":"aws_cloudwatch.message_obj.httpRequest.httpMethod"},"value_field":"doc_count"}},"id":3},{"name":"AWS WAF - Block Activity - Area Chart","object_type":"chart","data":{"aggs":[{"field":"timestamp","info":["timestamp"],"interval":"1h","metric":"doc_count","metric_field":"","name":"time","type":"time"}],"chart_type":"line","config":{"filter_type":"","index":"aella-syslog-*","label_x":"","label_y":"Events","query_type":{"cats":[0],"type":"custom"},"stack":false,"title":"AWS WAF - Block Activity - Area Chart","title_color":"#FAFAFA"}},"id":4},{"name":"URI Piechart for Non-Prod","object_type":"chart","data":{"aggs":[{"direction":"desc","field":"aws_cloudwatch.message_obj.httpRequest.uri.keyword","info":["aws_cloudwatch.message_obj.httpRequest.uri"],"metric":"doc_count","metric_field":"","name":"Column 1","size":20,"type":"bucket"}],"chart_type":"donut","config":{"filter_type":"aws_cloudwatch.message_obj.httpRequest.uri.keyword","index":"aella-syslog-*","label_field":"aws_cloudwatch.message_obj.httpRequest.uri","query_type":{"cats":[0],"type":"custom"},"title":"URI Piechart for Non-Prod","value_field":"doc_count"}},"id":5}],"queries":[{"name":"BB_WAF_PRO_query","object_type":"query","data":{"must":[{"match":{"engid":{"query":"aws_cloudwatch_BB_AWS_CloudWatch","operator":"AND"}}},{"match":{"msg_origin.category":{"query":"waf","operator":"AND"}}},{"match":{"aws_cloudwatch.message_obj.action":{"query":"BLOCK","operator":"AND"}}}]},"id":0}]}